{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<meta name="referrer" content="always">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no,address=no,email=no">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
	<!-- No cache -->
	<meta http-equiv="Expires" content="-1">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache; no-store; no-save">
	<!-- Summary -->
	<meta name="Keywords" content="ìë™ì°¨, ìë™ì°¨ë‰´ìŠ¤, ì‹œìŠ¹ê¸°, ì¤‘ê³ ì°¨ë‰´ìŠ¤, ì‹ ì°¨ë‰´ìŠ¤, ìë™ì°¨ì—…ê³„, ìë™ì°¨ì—…ê³„ë‰´ìŠ¤">
	<meta name="Description" content="ì¹´ë¼ìŠ¤ 8ê°œ ìë™ì°¨ ì–¸ë¡ ì‚¬ë“¤ì˜ ë‰´ìŠ¤ë¥¼ ëª¨ì•„ ì œê³µí•©ë‹ˆë‹¤. (ì‹ ì°¨, ì¤‘ê³ ì°¨, ì‹œìŠ¹ê¸°, ìë™ì°¨ì—…ê³„)">
	<meta http-equiv="Author" content="ì¹´ë¼ìŠ¤">
	<meta http-equiv="Other Agent" content="ì¹´ë¼ìŠ¤">
	<meta http-equiv="Reply-To" content="simbk0120@autoplus.co.kr">
	<meta http-equiv="Email" content="simbk0120@autoplus.co.kr">
	<meta http-equiv="Build" content="2020.12" />
	<meta property="og:url" content="http://caras.autoplus.co.kr">
	<meta property="og:title" content="ì¹´ë¼ìŠ¤ CarAs">
	<meta property="og:type" content="website">
	<meta property="og:image" content="{% static 'images/common/img_share.png' %}">
	<meta property="og:description" content="ì¹´ë¼ìŠ¤, ìë™ì°¨ ë‰´ìŠ¤, ì¤‘ê³ ì°¨ ë‰´ìŠ¤, ì‹ ì°¨ ë‰´ìŠ¤, ìë™ì°¨ ì‹œìŠ¹ê¸°">
	<meta name="naver-site-verification" content="c7ce06c9ed9736eb46db21ed102e4dea95dfe089" />
	<meta name="google-site-verification" content="jt2p5-PNGgED4Z5xiMbyiENXRz7QGQtd6HxuQbAHYWw" />
	<title>ì¹´ë¼ìŠ¤ | CaR AnalysiS</title>
	<link rel="shortcut icon" href="{% static 'favico.png' %}" />
	<!-- CSS -->
	<link rel="stylesheet" href="{% static 'css/reset.css' %}">
	<link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">
	<link rel="stylesheet" href="{% static 'css/swiper.css' %}">
	<link rel="stylesheet" href="{% static 'css/content.css' %}">
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script data-ad-client="ca-pub-3984460457062336" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-T4CL1V9FXP"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'G-T4CL1V9FXP');

		function keywordSearch(){
			var nowListLength = $('.news-group li').length;
			var keyword = $('#search_keyword').val();
			if(keyword.length > 0){
				loadNewsList(99, 'all', 0, 12, 'search', null, keyword);
				$('#wrap').prop('class', '').addClass('search-result');
				$('.search-box').removeClass('show');
			}else{
				alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
				$('#search_keyword').focus();
			}
		}
	</script>	
</head>
<body>
{% if page_group == 'login-p' or page_group == 'join-p' %}
<div id="wrap" class="member-p">
{% elif page_group == 'news-detail-p' %}
<div id="wrap" class="news-detail-p">
{% else %}
<div id="wrap">
{% endif %}
	<header class="header">
		{% if page_group != 'news-detail-p' %}
		<a href="javascript:;" class="btn-gnb" title="ë©”ë‰´"></a>
		{% endif %}
		{% if page_group == 'news-list' %}
		<h1 class="service-name search-on">
		{% else %}
		<h1 class="service-name">
		{% endif %}
			<a href="/"><span>C</span>a<span>R</span> <span>A</span>nalysi<span>S</span></a><sup>Beta!</sup><br>
			
			<div class="search-box">
				{% csrf_token %}
				<input type="text" id="search_keyword" name="" placeholder="ê²€ìƒ‰í•  ë‹¨ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.">
				<button type="button" class="btn-search" onclick="keywordSearch();">ê²€ìƒ‰</button>
			</div>
		</h1>	
		<div class="fncs">
			{% comment %} {% if user %}
				<a href="/logout/" class="btn-login">ë¡œê·¸ì•„ì›ƒ</a>
			{% else %}
				<a href="/join/" class="btn-logout">íšŒì›ê°€ì…</a>
				<a href="/login/" class="btn-logout">ë¡œê·¸ì¸</a>
			{% endif %} {% endcomment %}
			{% if page_group != 'news-detail-p' %}
			<div class="box">
				<select name="" id="" class="view-mode-changer">
					<option value="dark">Dark mode</option>
					<option value="light" selected>Light mode</option>
				</select>
				{% comment %} <button type="button" title="ê²€ìƒ‰ì°½ ì—´ê¸°" class="btn-open-search">ğŸ”</button> {% endcomment %}
			</div>
			{% endif %}
		</div>
		<section class="gnb-box">
			<div class="dim"></div>
			<div class="box">
				<nav class="menu">
					<ul>
						<li class="active">
							<a href="/news_list">ìë™ì°¨ ê´€ë ¨ ë‰´ìŠ¤ ë³´ê¸°</a>
							<ul>
								<li class="active">&middot; <a href="javascript:;" onclick="loadNewsList(0, 'category', 0, 12, 'default', 'change');">ë‰´ìŠ¤ ì¹´í…Œê³ ë¦¬ë³„ ë³´ê¸°</a></li>
								<li>&middot; <a href="javascript:;" onclick="loadNewsList(0, 'media', 0, 12, 'default', 'change');">ì–¸ë¡ ì‚¬ë³„ ë³´ê¸°</a></li>
							</ul>
						</li>
						{% comment %} <li>
							<a href="/car_comments/">ì°¨ëŸ‰ ëª¨ë¸ë³„ ì—¬ë¡  í‰ê°€</a>
						</li> {% endcomment %}
						{% comment %} <li>
							<a href="javascript:;">ë§ˆì´í˜ì´ì§€</a>
							<ul>
								<li>&middot;  <a href="javascript:;">ì°œí•œ ë‰´ìŠ¤ ëª©ë¡</a></li>
							</ul>
						</li> {% endcomment %}
						<li>
							<a href="javascript:;">ì¹´ë¼ìŠ¤</a>
							<ul>
								{% comment %} <li>&middot;  <a href="javascript:;">ì¹´ë¼ìŠ¤ ì†Œê°œ</a></li> {% endcomment %}
								<li>&middot;  <a href="mailto:simbk0120@autoplus.co.kr">ì¹´ë¼ìŠ¤ ë¬¸ì˜(ì œì•ˆ)í•˜ê¸°</a></li>
							</ul>
						</li>
					</ul>
				</nav>
			</div>
		</section>
	</header>

	<!-- Javascript -->
	<script type="text/javascript" src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/jquery-ui.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/swiper.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/common.js' %}"></script>
	<script>
	$('.gnb-box .menu ul > li').removeClass('active');
	var thisPath = window.location.pathname;		
	{% comment %} console.log(thisPath) {% endcomment %}
	if(thisPath == '/' || thisPath == '/news_list' || thisPath == '/news_list/'){
		$('.gnb-box .menu > ul > li').eq(0).addClass('active');
	}else if(thisPath == '/car_comments/' || thisPath == '/car_comments'){
		$('.gnb-box .menu > ul > li').eq(1).addClass('active');
	}
	
	//news view count
	$(document).on('click', '.item-list ul li a', function(){
		var idx = $(this).parent('li').index();
		var nowCount = $(this).find('.infos').find('.view-cnt').children('strong').text();
		var newsCode = $('this').parent('li').data('news-code');
		{% comment %} alert('idx = '+ idx + ' / newscount=' + nowCount + ' / newscode = ' + newsCode) {% endcomment %}
		viewCountUp(idx, nowCount, newsCode)
	});
	//news list > view count
	function viewCountUp(idx, nowCount, newsCode){
		console.log(nowCount +'@@@' + newsCode)
		$.ajax({
			url: '{% url "view_count" %}',
			type: 'GET',
			data: {
				'now_count': nowCount,
				'news_code': newsCode
			},
			dataType: 'json',
			success: function(data){
				$('.news-group.show li').eq(idx).find('.view-cnt').children('strong').text(data);
			}
		});
	}
	function showNewsDetail(newsCode){
		var keyword = $('#search_keyword').val();
		if(keyword.length > 0){
			url = '/news_detail?news_code='+ newsCode + '&keyword=' + keyword;
		}else{
			url = '/news_detail?news_code='+ newsCode;
		}
		window.open(url, 'ì¹´ë¼ìŠ¤ ë‰´ìŠ¤ ìƒì„¸ë³´ê¸°', 'width=1040, height=850, toolbar=no, menubar=no, scrollbars=no, resizable=yes')
	}
	function loadNewsList(idx, list_type, start_idx, load_length, load_type, fnc_type, search_keyword){
		console.log('@@@', list_type)
		$('.loading').show();
		connFlag = true;
		$.ajax({
			url: '{% url "list_data" %}',
			type: 'GET',
			data: {
				'list_idx': idx,
				'list_type': list_type,
				'start_idx': start_idx,
				'load_length': load_length,
				'search_keyword': search_keyword
			},
			dataType: 'json',
			success: function(data){
				$('.loading').hide();
				var newsItem = "";		
				json_data = JSON.parse(data.news)
				total_length = data.total_length
				today_news = data.today_news
				category_idx = 0
				if(list_type == 'category'){
					for(cnt in today_news){
						if(today_news[cnt] > 0){
							$('.category-list .sub-menu.category li').eq(category_idx).addClass('new')
						}
						category_idx++
					}
				}else if(list_type == 'media'){
					for(cnt in today_news){
						if(today_news[cnt] > 0){
							$('.category-list .sub-menu.media li').eq(category_idx).addClass('new')
						}
						category_idx++
					}
				}
				{% comment %} console.log(total_length) {% endcomment %}
				console.log(json_data)
				for(i = 0; i < json_data.length; i++){
					list = json_data[i].fields;
					var media_name = '';
					if(list.media_code == '100'){
						media_name = 'ah'
					}else if(list.media_code == '200'){
						media_name = 'daily'
					}else if(list.media_code == '300'){
						media_name = 'auto-view'
					}else if(list.media_code == '400'){
						media_name = 'chosun'
					}else if(list.media_code == '500'){
						media_name = 'auto-morning'
					}else if(list.media_code == '600'){
						media_name = 'auto-diary'
					}else if(list.media_code == '700'){
						media_name = 'carguy'
					}else if(list.media_code == '800'){
						media_name = 'drive'
					}else if(list.media_code == '900'){
						media_name = 'motor-graph'
					}
					newsItem += '<li data-news-code="' + list.news_code + '">';
					newsItem += '<a href="javascript:;" title="' + list.news_title + '" onclick="showNewsDetail(\''+ list.news_code +'\')">';
					{% comment %} newsItem += '<a href="' + list.news_url + '" target="_blank" title="' + list.news_title + '" >'; {% endcomment %}
					if(list.media_code == '200' || /*list.media_code == '500' ||*/ list.news_img_url == 'None' || list.news_img_url == ''){
						newsItem += '<div class="picture">';
						newsItem += '<p><span class="ico">ğŸ˜°</span><br>í•´ë‹¹ ì–¸ë¡ ì‚¬ì—ì„œ<br>ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
						newsItem += '</div>';
					}else{
						newsItem += '<div class="picture" style="background:url(\'' + list.news_img_url + '\') no-repeat center; background-size:cover;"></div>';
					}
					newsItem += '<div class="info-box">';
					newsItem += '<div class="tags">';
					if(list.write_date == '{{ today_date|escapejs }}'){
						newsItem += '<span class="today">TODAY</span>';
					}
					newsItem += '<span class="'+ media_name +'">' + list.media_name + '</span>';
					newsItem += '</div>';
					newsItem += '<p class="subject">' + list.news_title + '</p>';
					if(list.news_summary.length == 0){
						newsItem += '<p class="summary">' + list.news_content + '</p>';
					}else {

						newsItem += '<p class="summary">' + list.news_summary + '</p>';
					}
					newsItem += '</div>';
					newsItem += '<div class="infos">';
					newsItem += '<span class="date">' + list.write_date + '</span>';
					newsItem += '<span class="view-cnt" title="ì´ ê¸°ì‚¬ ì¡°íšŒìˆ˜">ğŸ‘ <strong>' + list.view_count + '</strong></span>'
					{% comment %} newsItem += '<button type="button" class="btn-like" title="ì´ ê¸°ì‚¬ ì°œí•˜ê¸°">ğŸ‘ <strong>0</strong></button>'; {% endcomment %}
					newsItem += '</div>'
					newsItem += '<div class="mining-result">';
					if(list.positive_count > 0 || list.negative_count > 0){
						negaPer = Math.floor(100 * list.negative_count / (list.negative_count + list.positive_count))
						posiPer = 100 - negaPer
						{% comment %} if(list.positive_count > list.negative_count){
							negaPer = Math.floor(list.negative_count / list.positive_count * 100)
							posiPer = 100 - negaPer
						}else if(list.positive_count < list.negative_count){
							posiPer = Math.floor(list.positive_count / list.negative_count * 100)
							negaPer = 100 - posiPer
						}	 {% endcomment %}

						if(list.va_count > 0 || list.morpheme_count > 0){
							vaPer = Math.floor(list.va_count / list.morpheme_count)
						}
						newsItem += '<div class="positive" style="width:'+ posiPer +'%" title="ê¸ì •ë‹¨ì–´ ë…¸ì¶œ ìˆ˜ : '+list.positive_count+'ê°œ">ê¸ì • '+ posiPer +' %</div>'
						newsItem += '<div class="negative" style="width:'+ negaPer +'%" title="ë¶€ì •ë‹¨ì–´ ë…¸ì¶œ ìˆ˜ : '+list.negative_count+'ê°œ">ë¶€ì • '+ negaPer +' %</div>'	
						newsItem += '</div>';
						newsItem += '<div class="mining-view">'
						newsItem += '<p>ê°ì„±ì§€ìˆ˜ : '+vaPer+'% ('+list.va_count+'ê°œ/'+list.morpheme_count+'ê°œ)<br>ê¸/ë¶€ì • ë‹¨ì–´ ì‚¬ìš© ë¹ˆë„ìœ¨ : <span class="posi">'+posiPer+'%</span>/<span class="nega">'+negaPer+'%</span><br>ê¸/ë¶€ì • ë‹¨ì–´ ì‚¬ìš© ìˆ˜ : <span class="posi">'+list.positive_count+'ê°œ</span>/<span class="nega">'+list.negative_count+'ê°œ</span></p>'
						newsItem += '</div>'
					}else{
						newsItem += '<p class="txt-ing">ë¶„ì„ ì¤‘ì¸ ë‰´ìŠ¤ê¸°ì‚¬ì…ë‹ˆë‹¤.</p>';
						newsItem += '</div>';
						newsItem += '<div class="mining-view"><p>ë¶„ì„ ì¤‘ì¸ ë‰´ìŠ¤ê¸°ì‚¬ì…ë‹ˆë‹¤.</p></div>'
						{% comment %} <div class="mining-view"><p>ê°ì„±ì§€ìˆ˜ : '+vaPer+'% ('+list.va_count+'ê°œ/'+list.morpheme_count+'ê°œ)<br>ê¸/ë¶€ì • ë‹¨ì–´ ì‚¬ìš© ë¹ˆë„ìœ¨ : <span class="posi">'+posiPer+'%</span>/<span class="nega">'+negaPer+'%</span></p></div> {% endcomment %}
					}
					newsItem += '</a>';
					newsItem += '</li>';
				}

				if(load_type == 'more'){
					$('.news-group').append(newsItem);
					var nowScrollTop = $('html, body').scrollTop();
					$('html, body').animate({scrollTop: nowScrollTop + 100}, 150);
				}else{
					$('.news-group').html(newsItem);
					$('document, html').scrollTop(0);
				}

				if(load_type == 'search'){
					var keyword = $('#search_keyword').val();
					$('.result-info p span').text(keyword);
					$('.result-info p strong').text(total_length);
					$('.category-list .sub-menu').removeClass('show');
					$('.category-list .result-info').addClass('show');
				}

				//sub menu
				console.log(list_type)
				if(fnc_type == 'change'){
					$('.category-list ul').removeClass('show');
					$('.category-list ul li').removeClass('active');
					$('.category-list .result-info').removeClass('show');

					if(list_type == 'category'){
						$('#wrap').prop('class', '').addClass('category');
						$('.category-list ul.category').addClass('show');
					}else if(list_type == 'media'){
						$('#wrap').prop('class', '').addClass('media');
						$('.category-list ul.media').addClass('show');
					}
					$('.category-list ul.sub-menu.show li').eq(0).addClass('active');
				}

				//close gnb box
				$('.header .btn-gnb').removeClass('active');
				$('.gnb-box, .header .fncs').removeClass('show');
				connFlag = false;
			},
			error : function(request, status, error){
				console.log(error)
			},
		});
	}
	</script>
	{% block content %}{% endblock %}
{% comment %} //news load
var date = new Date();
var year = date.getFullYear()
var month = new String(date.getMonth() + 1);
var day = new String(date.getDate());
if(month.length == 1){
	month = '0' + month;
}
if(day.length == 1){
	day = '0' + day;
}
todayDate = year + '-' + month + '-' + day
alert(today) {% endcomment %}